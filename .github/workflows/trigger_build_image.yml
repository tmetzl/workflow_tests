name: Trigger build image
        
on:
  workflow_dispatch:
    inputs: 
      force_build:
        description: If the build should be forced even if there are no changes
        type: boolean
        required: false
        default: false

jobs:
  checkout_repo:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repo
        uses: actions/checkout@v4
  build_base_image:
    needs: checkout_repo
    uses: ./.github/workflows/fake_build_image.yml
    with:
      force_build: ${{ inputs.force_build }}
      image: "base_image"
  print_output_of_build_base_image:
    runs-on: ubuntu-latest
    needs: [build_base_image]
    steps: 
      - id: print_output
        env:
          WAS_BUILT: ${{ needs.build_base_image.outputs.did_build_image}}
        run:
          echo "Was it built? $WAS_BUILT"
  build_derived_image:
    needs: [build_base_image]
    uses: ./.github/workflows/fake_build_image.yml
    if: ${{ needs.build_base_image.outputs.did_build_image == 'true' }}
    with:
      force_build: ${{ inputs.force_build }}
      image: "derived_image"
